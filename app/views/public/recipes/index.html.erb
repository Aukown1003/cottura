<div class="container-fluid p-0">
  <div class="row">
    <%= form_with url: search_recipe_path, method: :get, id:"categorySearchForm" do |f| %>
      <div class="d-flex justify-content-around">
        <% @genres.each do |genre| %>
          <div class="col gnavi__list bg-secondary text-white">
            <h5 class="text-center pt-3"><%= genre.name %></h5>
            <ul class="dropdown__lists">
              <% genre.categories.each do |category| %>
              <li class="dropdown__list">
                <%= link_to category.name, search_recipe_path(category_id: category.id), class:"btn btn btn-light" %>
              </li>
              <% end %>
              <!--<%#= f.collection_check_boxes(:category_id, genre.categories, :id, :name) do |b| %>-->
              <!--  <li class="dropdown__list bg-secondary">-->
              <!--    <label>-->
              <!--      <span class="ps-2"><#%= b.check_box %></span>-->
              <!--      <span class="ps-2"><#%= b.text %></span>-->
              <!--    </label>-->
              <!--  </li>-->
              <!--<%# end %>-->
            </ul>
          </div>
        <% end %>
      </div>
      <%#= f.submit "絞り込み表示", class:"btn btn-primary w-100" %>
    <% end %>
      
  </div>
</div>

<% if session[:category_id].present? %>
  <div>
    <% @categories.each do |category| %>
      <sapn class>
        <%= link_to category.name, category_id_delete_recipe_path(destroy_category_id: category.id), method: :delete, class:"btn btn-secondary" %>
      </span>
    <% end %>
              
    <%= form_with url: category_id_delete_recipe_path, method: :delete do |f| %>
      <%= f.collection_check_boxes(:destroy_category_id, @categories, :id, :name) do |b| %>
        <%= b.label { b.check_box + b.text } %>
      <% end %>
      <%= link_to "全てのカテゴリーを削除", category_id_all_delete_recipe_path, method: :delete, class:"btn btn-danger" %>
      <div class="mt-3"><%= f.submit "削除" %></div>
    <% end %>
  </div>
<% end %>

</div>

<div class="container my-5">
  <div class="row">
    <% @recipes.each do |recipe| %>
    <div class="group neumorphism index-item col-sm-6 col-md-4 col-lg-3 col-xxl-2 mb-2">

      <div class="box index-item-parts bg-secondary text-white rounded">
        <div class="text-center pt-2">
          <%= link_to image_tag(recipe.get_recipe_index_image(200, 200)), recipe_path(recipe.id), class:"img-fluid" %>
        </div>
        <group>
          <div class="fw-bold text-truncate mt-1 px-2 px-sm-4 ps-xl-4 px-md-2">
            <%= link_to recipe.title, recipe_path(recipe.id), class: "link-light" %>
          </div>

          <div class="px-2 px-sm-4 ps-xl-4 px-md-2">
            <%= recipe.view_time_data %>
          </div>

          <div class="mb-2 pb-2 pX-2 px-sm-4 ps-xl-4 px-md-2">
            ここにレビュー機能
          </div>
        </group>
      </div>

    </div>
    <% end %>
  </div>
</div>

<script>
  // const elements = document.getElementsByClassName("category_id")
  // const form = document.getElementById('categorySearchForm')
  // for(let i = 0; i < elements.length; i++) {
  //   elements[i].addEventListener('change', ()=> {
  //     // document.forms[form].submit();
  //     this.form.submit();
  //   })
  // }
</script>